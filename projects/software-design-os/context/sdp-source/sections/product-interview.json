{
  "name": "Product Interview",
  "parentSection": "Product Definition Editor",
  "route": "/projects/:id/stage/1",
  "description": "A guided interview flow that walks users through structured questions to extract the critical information needed for a strong product definition. Replaces the blank textarea with an intelligent, step-by-step intake process that feeds into AI generation.",

  "concept": {
    "overview": "When a user creates a new project and lands on Stage 1, they don't see an empty form. Instead, they enter the Product Interview — a conversational wizard that asks the right questions in the right order. Each question builds on previous answers. The AI can ask smart follow-ups. Once the interview is complete, the structured Product Definition is generated from the collected answers.",
    "modes": {
      "guided": "Step-by-step wizard with one question per screen. Best for users who want hand-holding.",
      "quick": "Single-page form with all questions visible. Best for experienced users who know what they want.",
      "conversational": "Chat-style interface where AI asks questions and the user responds naturally. AI extracts structured data from free-form answers."
    },
    "defaultMode": "guided"
  },

  "interviewSteps": [
    {
      "step": 1,
      "id": "elevator-pitch",
      "question": "What are you building?",
      "subtext": "Describe your product in 1-3 sentences. Think of it as your elevator pitch.",
      "inputType": "textarea",
      "placeholder": "e.g., A personal dashboard for managing AI agents. It shows what each agent is doing, tracks costs, and lets me schedule recurring tasks.",
      "required": true,
      "minLength": 20,
      "aiFollowUp": true,
      "aiFollowUpPrompt": "Based on the user's pitch, ask 1-2 clarifying questions about scope or target audience if the description is vague.",
      "extractsTo": ["name", "description", "tagline"]
    },
    {
      "step": 2,
      "id": "target-users",
      "question": "Who is this for?",
      "subtext": "Describe who will use this product. Be specific about their role, technical skill level, and what they're currently doing without your tool.",
      "inputType": "textarea",
      "placeholder": "e.g., Solo developers who use AI coding agents like Claude Code and Cursor. They're technical but don't have time to build monitoring tools from scratch.",
      "required": true,
      "aiFollowUp": true,
      "aiFollowUpPrompt": "If the user describes one persona, ask if there are secondary users. If vague, ask about technical skill level and current workflow.",
      "extractsTo": ["personas"]
    },
    {
      "step": 3,
      "id": "pain-points",
      "question": "What problems does this solve?",
      "subtext": "List the specific frustrations, inefficiencies, or gaps your users face today. What's painful or broken about their current workflow?",
      "inputType": "multi-textarea",
      "placeholder": "e.g., I have no idea how much I'm spending on AI API calls each month",
      "minItems": 1,
      "maxItems": 8,
      "addButtonLabel": "+ Add another problem",
      "required": true,
      "aiFollowUp": true,
      "aiFollowUpPrompt": "If the user lists fewer than 3 problems, suggest potential problems based on the product description and target users. Ask 'Does this also apply?'",
      "extractsTo": ["problems"]
    },
    {
      "step": 4,
      "id": "key-features",
      "question": "What are the must-have features?",
      "subtext": "List the core features your product needs to have on day one. Don't worry about nice-to-haves — focus on what makes this product useful.",
      "inputType": "multi-textarea",
      "placeholder": "e.g., Real-time dashboard showing all agent activity",
      "minItems": 1,
      "maxItems": 12,
      "addButtonLabel": "+ Add another feature",
      "required": true,
      "aiFollowUp": true,
      "aiFollowUpPrompt": "Based on the problems listed, suggest 2-3 features the user may have missed. Ask 'Should I include these?'",
      "extractsTo": ["features"]
    },
    {
      "step": 5,
      "id": "existing-solutions",
      "question": "What do people use today instead?",
      "subtext": "What existing tools, workarounds, or manual processes do your target users rely on? This helps position your product.",
      "inputType": "textarea",
      "placeholder": "e.g., People check their API provider dashboards manually, use spreadsheets to track costs, or just don't monitor at all.",
      "required": false,
      "aiFollowUp": false,
      "extractsTo": ["competitive_context"]
    },
    {
      "step": 6,
      "id": "differentiator",
      "question": "What makes your approach different?",
      "subtext": "Why would someone choose your product over the alternatives? What's the unique angle?",
      "inputType": "textarea",
      "placeholder": "e.g., It's the only tool that combines agent monitoring, cost tracking, and task scheduling in one place — built specifically for solo AI builders, not enterprise teams.",
      "required": false,
      "aiFollowUp": false,
      "extractsTo": ["differentiator", "tagline"]
    },
    {
      "step": 7,
      "id": "scope-constraints",
      "question": "Any constraints or preferences?",
      "subtext": "Is there anything the AI should know about scope, technical constraints, timeline, or design preferences?",
      "inputType": "checkbox-and-textarea",
      "checkboxOptions": [
        {"label": "Solo project — keep it simple", "value": "solo"},
        {"label": "MVP first — minimal viable features only", "value": "mvp"},
        {"label": "Must work offline / locally", "value": "local"},
        {"label": "Needs authentication / multi-user", "value": "auth"},
        {"label": "Mobile-responsive required", "value": "mobile"},
        {"label": "Real-time / WebSocket features", "value": "realtime"},
        {"label": "Heavy data visualization", "value": "dataviz"}
      ],
      "textareaLabel": "Anything else the AI should know?",
      "placeholder": "e.g., I want this to feel like a NASA mission control dashboard. Dark theme preferred.",
      "required": false,
      "extractsTo": ["constraints", "preferences"]
    }
  ],

  "components": [
    {
      "name": "InterviewModeSelector",
      "description": "Three cards at the top of Stage 1 when it's empty: Guided (step-by-step wizard), Quick (all questions on one page), Conversational (chat with AI). User picks their preferred mode.",
      "props": ["selectedMode: guided|quick|conversational", "onSelect"]
    },
    {
      "name": "GuidedWizard",
      "description": "Step-by-step interview with one question per screen. Progress bar at top showing current step and total steps. Previous/Next buttons. Each step shows the question, subtext, input field, and optional AI follow-up bubble.",
      "children": ["InterviewStep", "WizardProgressBar", "AIFollowUpBubble"],
      "props": ["steps: InterviewStep[]", "currentStep: number", "answers: Record<string, any>", "onAnswer", "onNext", "onPrevious"]
    },
    {
      "name": "WizardProgressBar",
      "description": "Horizontal progress indicator showing 7 steps. Current step is highlighted. Completed steps show checkmarks. Shows step title under each dot.",
      "props": ["totalSteps: number", "currentStep: number", "stepLabels: string[]"]
    },
    {
      "name": "InterviewStep",
      "description": "Single question screen with large question text, helpful subtext, and the appropriate input field (textarea, multi-textarea with add button, or checkbox group + textarea). Clean, focused layout with generous whitespace.",
      "props": ["step: StepConfig", "value: any", "onChange"]
    },
    {
      "name": "AIFollowUpBubble",
      "description": "After the user answers a question, the AI can optionally ask a follow-up to clarify or deepen the response. Appears as a subtle chat bubble below the input. User can answer inline or skip. Shows typing indicator while AI thinks.",
      "props": ["followUpQuestion: string", "onAnswer: (response: string) => void", "onSkip"]
    },
    {
      "name": "QuickForm",
      "description": "Single-page form showing all 7 questions at once in a scrollable layout. Each question is a collapsible section. Good for users who want to fill everything out quickly.",
      "props": ["steps: InterviewStep[]", "answers: Record<string, any>", "onChange"]
    },
    {
      "name": "ConversationalInterview",
      "description": "Chat-style interface where the AI asks questions one at a time in a conversation thread. User types natural language responses. AI extracts structured data from responses and asks follow-ups. Conversation is saved as context for generation.",
      "props": ["messages: Message[]", "onSend: (text: string) => void", "extractedData: Partial<ProductDefinition>"],
      "aiPrompt": "You are interviewing a user about their software product idea. Ask questions one at a time. Start with 'What are you building?' and follow up based on their responses. Extract: product name, description, target personas, problems/solutions, key features, and constraints. Be conversational but focused. After 5-8 exchanges, summarize what you've learned and ask if anything is missing."
    },
    {
      "name": "InterviewSummary",
      "description": "After all questions are answered (any mode), shows a summary card of all collected information before generation. User can edit any field. Has a prominent 'Generate Product Definition' button that sends all answers to the AI for structured expansion.",
      "props": ["answers: InterviewAnswers", "onEdit: (stepId: string) => void", "onGenerate"]
    },
    {
      "name": "GenerationTransition",
      "description": "Animated transition that plays after clicking Generate. Shows a progress indicator with stage-specific messaging: 'Analyzing your product idea...', 'Identifying target personas...', 'Generating feature specifications...', 'Crafting problem/solution pairs...'. Transitions to the structured Product Definition view when complete.",
      "props": ["isGenerating: boolean", "progress: number", "currentPhase: string"]
    }
  ],

  "flow": {
    "newProject": [
      "User creates project → lands on Stage 1",
      "Stage 1 shows InterviewModeSelector (Guided / Quick / Conversational)",
      "User picks a mode and starts answering questions",
      "After all questions: InterviewSummary shows collected answers",
      "User clicks 'Generate Product Definition'",
      "GenerationTransition plays while AI processes",
      "AI generates full ProductDefinition from interview answers",
      "Structured view loads with all sections populated",
      "User can edit any section inline",
      "User clicks 'Validate & Complete' to advance to Stage 2"
    ],
    "returningUser": [
      "User returns to Stage 1 with existing data",
      "Shows the structured Product Definition editor (current view)",
      "Can re-enter interview mode via 'Re-interview' button to update answers",
      "Can edit inline directly",
      "Can click 'Regenerate' to re-run AI with current data"
    ]
  },

  "aiGenerationPrompt": {
    "description": "The prompt template that takes interview answers and generates the structured Product Definition. This is what the Generate button triggers.",
    "systemPrompt": "You are a product strategist helping define a software product. Given a set of interview responses, generate a comprehensive product definition.",
    "inputTemplate": "Based on the following interview responses, generate a structured product definition:\n\n**Elevator Pitch:** {elevator-pitch}\n**Target Users:** {target-users}\n**Problems:** {pain-points}\n**Must-Have Features:** {key-features}\n**Current Alternatives:** {existing-solutions}\n**Differentiator:** {differentiator}\n**Constraints:** {scope-constraints}\n\nGenerate:\n1. Product name and tagline\n2. Full description (2-3 sentences)\n3. Problem/Solution pairs (expand each problem into a clear problem statement and specific solution)\n4. Key features with names and descriptions\n5. Target personas with names, descriptions, and characteristics\n\nOutput as JSON matching the ProductDefinition schema.",
    "outputSchema": "ProductDefinition (same as current Stage 1 data schema)"
  },

  "dataRequirements": ["Stage (stageNumber=1)", "AIProviderConfig (for generation)"],

  "interactions": [
    {"trigger": "Select interview mode", "behavior": "Load Guided Wizard, Quick Form, or Conversational Interview"},
    {"trigger": "Answer question + Next", "behavior": "Save answer → check for AI follow-up → advance to next step"},
    {"trigger": "AI follow-up appears", "behavior": "User can answer to refine or skip"},
    {"trigger": "Complete all steps", "behavior": "Show InterviewSummary with all collected answers"},
    {"trigger": "Click Generate", "behavior": "Send all answers to AI → show GenerationTransition → load structured view"},
    {"trigger": "Click Re-interview", "behavior": "Re-enter interview wizard with existing answers pre-filled"},
    {"trigger": "Edit inline", "behavior": "Direct editing on the structured output (current behavior)"}
  ],

  "stateManagement": {
    "serverState": "Interview answers stored as part of Stage 1 userInput field. Generated definition stored in Stage 1 data field.",
    "clientState": "currentMode, currentStep, answers (draft), isGenerating, aiFollowUpPending"
  }
}
